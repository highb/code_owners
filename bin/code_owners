#!/usr/bin/env ruby

$LOAD_PATH << File.join(File.dirname(__FILE__), '..', 'lib')
require 'code_owners'
require 'optparse'

options = {}
OptionParser.new do |opts|
  opts.banner = "usage: code_owners [options]"
  opts.on('-u', '--unowned', TrueClass, 'Display unowned files only') do |u|
    options[:unowned] = u
  end
end.parse!

CodeOwners.ownerships.each do |ownership_status|
  owner_info = ownership_status[:owner].dup
  next if options[:unowned] && owner_info != CodeOwners::NO_OWNER
  owner_info += " per line #{ownership_status[:line]}, #{ownership_status[:pattern]}" if owner_info != "UNOWNED"
  puts "#{ownership_status[:file].ljust(100,' ')} #{owner_info}"
end
